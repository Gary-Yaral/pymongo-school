<!DOCTYPE html>
<html lang="en">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../static/css/rojo.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <title>Test | Colores</title>
</head>
<body class="centered">
    <audio controls autoplay>
        <source src="../static/images/examen.mp3" alt="" type="audio/mp3">
    </audio>
    
    <div class="vidas">
        <img class="item vida1" src="../static/images/objetos/corazon.png" alt="">
        <img class="item vida2" src="../static/images/objetos/corazon.png" alt="">
        <img class="item vida3" src="../static/images/objetos/corazon.png" alt="">
    </div>
    <h1 class="mb-5">Test de los colores</h1>
    <div class="row">
        <img class="col-3" data-value="amarillo" src="../static/images/objetos/pollito.jpg" alt="">
        <img class="col-3" data-value="azul" src="../static/images/objetos/cielo.jpg" alt="">
        <img class="col-3" data-value="rojo" src="../static/images/objetos/tomate.jpg" alt="">
        <img class="col-3" data-value="azul" src="../static/images/objetos/mar.jpg" alt="">
        <img class="col-3" data-value="amarillo" src="../static/images/objetos/sol.jpg" alt="">
        <img class="col-3" data-value="rojo" src="../static/images/objetos/manzana.jpg" alt="">
        <img class="col-3" data-value="azul" src="../static/images/objetos/mariposa.jpg" alt="">
        <img class="col-3" data-value="amarillo" src="../static/images/objetos/banano.jpg" alt="">
    </div>

    <script
    src="https://code.jquery.com/jquery-3.6.0.min.js"
    integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
    crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.5/dist/umd/popper.min.js" integrity="sha384-Xe+8cL9oJa6tN/veChSP7q+mnSPaj5Bcu9mPX5F5xIGE0DVittaqT5lorf0EI7Vk" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.min.js" integrity="sha384-ODmDIVzN+pFdexxHEHFBQH3/9/vQ9uori45z4JjnFsRydbmQbmL5t1tQ0culUzyK" crossorigin="anonymous"></script>

    <script>
        let tiempo = 0

        setInterval(()=>{
            tiempo++
        }, 1000)

        $("#avanzar").on("click", function(){
            let storage = JSON.parse(localStorage.getItem("est-python"))
            let minutos = parseInt(tiempo / 60)
            storage.tiempo = minutos
            localStorage.setItem("est-python", JSON.stringify(storage))
            window.location = "/"
        })

        let counter = 0
        let respuestas = []
        $(".row").on("click", function(e){
            if(counter === 4) {

                return
            }

            if(e.target.classList.contains("col-3")) {
                counter++
                respuestas.push(e.target.dataset.value)
                let rojas = respuestas.filter(res => res === "rojo").length
                let amarillas = respuestas.filter(res => res === "amarillo").length
                let azules = respuestas.filter(res => res === "azul").length
                if(counter === 4) {
                    if(rojas === 2 && amarillas === 1 && azules === 1) {
                        Swal.fire(
                        'Felicidades!',
                        'Has completado el test correctamente!',
                        'success'
                        )

                        .then(ok => {
                            let data = JSON.parse(localStorage.getItem("est-python"))
                            $.post("saveData", {...data, tiempo}, function(response) {
                                console.log(response)

                            })
                        })

                    } else {
                        Swal.fire(
                        'Aww!',
                        'No has podido hacerlo correctamente! Intentalo de nuevo',
                        'error'
                        )
                        .then(ok=>{
                            $("vida1")
                        })
                    }
                }
                
            }

        })
    </script>
</body>
</html>

</body>
</html>
